---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
description: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/homomorphic_tree.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Homomorphic-trees">Homomorphic trees<a class="anchor-link" href="#Homomorphic-trees"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">seal</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="print_vector" class="doc_header"><code>print_vector</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>print_vector</code>(<strong><code>vec</code></strong>, <strong><code>print_size</code></strong>=<em><code>4</code></em>, <strong><code>prec</code></strong>=<em><code>3</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ptx_value" class="doc_header"><code>ptx_value</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ptx_value</code>(<strong><code>ptx</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ctx_value" class="doc_header"><code>ctx_value</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L35" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ctx_value</code>(<strong><code>ctx</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="print_ctx" class="doc_header"><code>print_ctx</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>print_ctx</code>(<strong><code>ctx</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="print_ptx" class="doc_header"><code>print_ptx</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>print_ptx</code>(<strong><code>ptx</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="chebyshev_approximation" class="doc_header"><code>chebyshev_approximation</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>chebyshev_approximation</code>(<strong><code>f</code></strong>, <strong><code>dilatation_factor</code></strong>=<em><code>50</code></em>, <strong><code>polynomial_degree</code></strong>=<em><code>25</code></em>, <strong><code>bound</code></strong>=<em><code>1</code></em>, <strong><code>convertToTensor</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="polynomial_approximation_coefficients" class="doc_header"><code>polynomial_approximation_coefficients</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>polynomial_approximation_coefficients</code>(<strong><code>f</code></strong>, <strong><code>dilatation_factor</code></strong>=<em><code>50</code></em>, <strong><code>polynomial_degree</code></strong>=<em><code>25</code></em>, <strong><code>bound</code></strong>=<em><code>1</code></em>, <strong><code>convertToTensor</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_graph_function_approximation" class="doc_header"><code>plot_graph_function_approximation</code><a href="https://github.com/dhuynh95/cryptotree/tree/master/cryptotree/he.py#L70" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_graph_function_approximation</code>(<strong><code>f</code></strong>, <strong><code>dilatation_factor</code></strong>=<em><code>50</code></em>, <strong><code>polynomial_degree</code></strong>=<em><code>25</code></em>, <strong><code>bound</code></strong>=<em><code>1</code></em>, <strong><code>convertToTensor</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dilatation_factor</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">degree</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">p</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">chebyshev_approximation</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span> <span class="n">dilatation_factor</span><span class="o">=</span><span class="n">dilatation_factor</span><span class="p">,</span>
                                              <span class="n">polynomial_degree</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">polynomial_approximation_coefficients</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span> <span class="n">dilatation_factor</span><span class="o">=</span><span class="n">dilatation_factor</span><span class="p">,</span>
                                              <span class="n">polynomial_degree</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span>
<span class="n">plot_graph_function_approximation</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span> <span class="n">dilatation_factor</span><span class="o">=</span><span class="n">dilatation_factor</span><span class="p">,</span>
                                              <span class="n">polynomial_degree</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;Figure size 432x288 with 1 Axes&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f4465094910&gt;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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eXNycnIYOnQoV199Nc899xwvvfTSGduk2KefflpmTADr168nOTmZNm3aMHr0aJYvX855551XtR2kCnZl7WL6muncNeguukd351d/sv19VHuq1DnRK5ZzUHzmGx8fT/v27bnrrrtYtmwZt956KwAXXHABmZmZHD9+/IzpfvzjH/PWW28B8NZbb3HHHd8/Lu2qq64CYMiQIezevRuAZcuWccsttwDQs2dPOnToUJJYxo0bR9OmTYmNjSUyMrIkSfTr169kerdFixYxfPhw+vXrx8KFC0lOTq5wHTdt2sSYMWPo168f77333hnjX3fddSUP4ezcuTNbtmwBYPz48URHRxMaGspVV13FsmXLAOjQoQMjRowoWacbb7wRf39/WrZsydixY1m9ejVhYWG89tprjB8/ngcffJAuXbqUGVfx3wP069ePPn360Lp1a4KDg+ncuTOpqfbvfl588UUGDBjAiBEjSE1NZfv27RWua3kxgX0gaLt27fDz82PgwIFllu25+M3i3+Dv589TY58iNxdeew2uuELbVlT91CCuWKp6ZeG14jaW6ho9ejS7d+9m8eLFFBYW0rdv35JhxY/P9/f3p6CgoNJ5lX7cvvtR/KWnz83N5f7772fNmjXExcUxdepUcnNzK5z/lClTmD17NgMGDGDGjBksXry4ZFjp/8Yo7i6vf5MmVXsMybfffkt0dDT79+8vd5zK/nJg8eLFLFiwgJUrVxIWFkZCQkKl61oR9zKqum2q6tuD3/Kvjf/isVGP0TaiLe+8Yx/t/sADni1CqVqlVyweGzNmDO+99x5g6+ZjYmKIKONPxG+77TZuuummM65WqjLPbdu2sXfvXnr06FHt2IoPrDExMWRnZ1fpLrATJ07QunVr8vPzS2Io9tFHH1FUVMSOHTvYuXNnSUz//e9/OXLkCDk5OcyePZvRo0eXuU6zZs2isLCQjIwMlixZwrBhw9izZw9/+tOfWL9+PfPmzeObb76p9noCHDt2jGbNmhEWFsaWLVv4+uuvS4YFBgaWtHFVJaaa9uuFvyYyJJLHz3scgJdftn8hfOGFNb5opWpEg7hiqUumTp3KnXfeSf/+/QkLCyv3j79uvvlmnnzySW688cZK53n//fdz33330a9fPwICApgxY8YZZ9BVFRUVxd13303fvn1p1apVlR6x//TTTzN8+HBiY2MZPnw4J06c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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">coeffs</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10.037836359607166</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PRECISION_BITS</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">UPPER_BITS</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">polynomial_multiplications</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">degree</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">n_polynomials</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">matrix_multiplications</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">depth</span> <span class="o">=</span> <span class="n">matrix_multiplications</span> <span class="o">+</span> <span class="n">polynomial_multiplications</span> <span class="o">*</span> <span class="n">n_polynomials</span>

<span class="n">poly_modulus_degree</span> <span class="o">=</span> <span class="mi">16384</span>

<span class="n">moduli</span> <span class="o">=</span> <span class="p">[</span><span class="n">PRECISION_BITS</span> <span class="o">+</span> <span class="n">UPPER_BITS</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">depth</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">PRECISION_BITS</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">PRECISION_BITS</span> <span class="o">+</span> <span class="n">UPPER_BITS</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">moduli</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">moduli</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[50, 35, 35, 35, 35, 35, 35, 35, 35, 50]
380
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parms</span> <span class="o">=</span> <span class="n">EncryptionParameters</span><span class="p">(</span><span class="n">scheme_type</span><span class="o">.</span><span class="n">CKKS</span><span class="p">)</span>
<span class="n">parms</span><span class="o">.</span><span class="n">set_poly_modulus_degree</span><span class="p">(</span><span class="n">poly_modulus_degree</span><span class="p">)</span>
<span class="n">parms</span><span class="o">.</span><span class="n">set_coeff_modulus</span><span class="p">(</span><span class="n">CoeffModulus</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span>
    <span class="n">poly_modulus_degree</span><span class="p">,</span> <span class="n">moduli</span><span class="p">))</span>

<span class="n">scale</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">PRECISION_BITS</span><span class="p">)</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">SEALContext</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">parms</span><span class="p">)</span>

<span class="c1"># Key creations</span>
<span class="n">keygen</span> <span class="o">=</span> <span class="n">KeyGenerator</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="n">public_key</span> <span class="o">=</span> <span class="n">keygen</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<span class="n">secret_key</span> <span class="o">=</span> <span class="n">keygen</span><span class="o">.</span><span class="n">secret_key</span><span class="p">()</span>
<span class="n">relin_keys</span> <span class="o">=</span> <span class="n">keygen</span><span class="o">.</span><span class="n">relin_keys</span><span class="p">()</span>
<span class="n">galois_keys</span> <span class="o">=</span> <span class="n">keygen</span><span class="o">.</span><span class="n">galois_keys</span><span class="p">()</span>

<span class="n">encryptor</span> <span class="o">=</span> <span class="n">Encryptor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="n">decryptor</span> <span class="o">=</span> <span class="n">Decryptor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">CKKSEncoder</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keygen2</span> <span class="o">=</span> <span class="n">KeyGenerator</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="n">public_key2</span> <span class="o">=</span> <span class="n">keygen2</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<span class="n">encryptor2</span> <span class="o">=</span> <span class="n">Encryptor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">public_key2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">coeffs_to_plaintext</span><span class="p">(</span><span class="n">coeffs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">CKKSEncoder</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">plain_coeffs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">coef</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">:</span>
        <span class="n">plain_coeff</span> <span class="o">=</span> <span class="n">Plaintext</span><span class="p">()</span>
        <span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">plain_coeff</span><span class="p">)</span>
        <span class="n">plain_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plain_coeff</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">plain_coeffs</span>

<span class="k">def</span> <span class="nf">compute_all_powers</span><span class="p">(</span><span class="n">ctx</span> <span class="p">:</span> <span class="n">Ciphertext</span><span class="p">,</span> <span class="n">degree</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">:</span> <span class="n">Evaluator</span><span class="p">,</span> 
                       <span class="n">relin_keys</span><span class="p">:</span> <span class="n">RelinKeys</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">powers</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">powers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span>
    <span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            
        <span class="n">minlevel</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">cand</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span>
            <span class="n">newlevel</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">levels</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">levels</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">newlevel</span> <span class="o">&lt;</span> <span class="n">minlevel</span><span class="p">:</span>
                <span class="n">cand</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">minlevel</span> <span class="o">=</span> <span class="n">newlevel</span>
                
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;i = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, i-cand = </span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="n">cand</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;level for cand : </span><span class="si">{</span><span class="n">levels</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span><span class="si">}</span><span class="s2">, level for </span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="n">cand</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">cand</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;minlevel = </span><span class="si">{</span><span class="n">minlevel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cand = </span><span class="si">{</span><span class="n">cand</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">minlevel</span>
        
        <span class="n">temp</span> <span class="o">=</span> <span class="n">Ciphertext</span><span class="p">()</span>
        
        <span class="n">power_cand</span> <span class="o">=</span> <span class="n">powers</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">mod_switch_to</span><span class="p">(</span><span class="n">power_cand</span><span class="p">,</span> <span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">cand</span><span class="p">]</span><span class="o">.</span><span class="n">parms_id</span><span class="p">(),</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">cand</span><span class="p">],</span> <span class="n">temp</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">relinearize_inplace</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">relin_keys</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">rescale_to_next_inplace</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        
        <span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
        
    <span class="k">return</span> <span class="n">powers</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">multiply_and_add_coeffs</span><span class="p">(</span><span class="n">powers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Ciphertext</span><span class="p">],</span> <span class="n">plain_coeffs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Plaintext</span><span class="p">],</span>
                            <span class="n">coeffs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                            <span class="n">evaluator</span><span class="p">:</span> <span class="n">Evaluator</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">:</span> <span class="n">Encryptor</span><span class="p">,</span>
                            <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">plain_coeffs</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Mismatch between length between powers </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span><span class="si">}</span><span class="s2"> and coeffs </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">Ciphertext</span><span class="p">()</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">ctx_value</span><span class="p">(</span><span class="n">powers</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">expected_output</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plain_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">output</span><span class="p">)</span>
    
    <span class="n">temp</span> <span class="o">=</span> <span class="n">Ciphertext</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plain_coeffs</span><span class="p">)):</span>
        <span class="c1"># We first check if the coefficient is not too small otherwise we skip it</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">continue</span>
            
        <span class="n">plain_coeff</span> <span class="o">=</span> <span class="n">plain_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="n">evaluator</span><span class="o">.</span><span class="n">mod_switch_to_inplace</span><span class="p">(</span><span class="n">plain_coeff</span><span class="p">,</span> <span class="n">power</span><span class="o">.</span><span class="n">parms_id</span><span class="p">())</span>
        
        <span class="n">evaluator</span><span class="o">.</span><span class="n">multiply_plain</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">plain_coeff</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">rescale_to_next_inplace</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        
        <span class="n">evaluator</span><span class="o">.</span><span class="n">mod_switch_to_inplace</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">parms_id</span><span class="p">())</span>
        <span class="n">output</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="n">PRECISION_BITS</span><span class="p">))</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="n">PRECISION_BITS</span><span class="p">))</span>
        <span class="n">evaluator</span><span class="o">.</span><span class="n">add_inplace</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
        
        <span class="n">expected_output</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> Expected output : </span><span class="si">{</span><span class="n">expected_output</span><span class="si">}</span><span class="s2">, output : </span><span class="si">{</span><span class="n">ctx_value</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">polyeval_tree</span><span class="p">(</span><span class="n">ctx</span> <span class="p">:</span> <span class="n">Ciphertext</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> 
                  <span class="n">evaluator</span><span class="p">:</span> <span class="n">Evaluator</span><span class="p">,</span> <span class="n">encoder</span> <span class="p">:</span> <span class="n">Encryptor</span><span class="p">,</span> <span class="n">encryptor</span> <span class="p">:</span> <span class="n">Encryptor</span><span class="p">,</span>
                  <span class="n">relin_keys</span><span class="p">:</span> <span class="n">RelinKeys</span><span class="p">,</span>
                  <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    
    <span class="n">degree</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">plain_coeffs</span> <span class="o">=</span> <span class="n">coeffs_to_plaintext</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="n">compute_all_powers</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="n">relin_keys</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">multiply_and_add_coeffs</span><span class="p">(</span><span class="n">powers</span><span class="p">,</span> <span class="n">plain_coeffs</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">float_to_ctx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">CKKSEncoder</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">:</span> <span class="n">Encryptor</span><span class="p">):</span>
    <span class="n">ptx</span> <span class="o">=</span> <span class="n">Plaintext</span><span class="p">()</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">ptx</span><span class="p">)</span>

    <span class="n">ctx</span> <span class="o">=</span> <span class="n">Ciphertext</span><span class="p">()</span>
    <span class="n">encryptor</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">ptx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ctx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">float_to_ctx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">polyeval_tree</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">,</span> <span class="n">relin_keys</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_ctx</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">dilatation_factor</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
    [ 0.9960416, 0.9960691, 0.9960705, ..., 0.9960374, 0.9960928, 0.9958946 ]

0.9958888653235468
tensor(1.0000)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">ctx1</span> <span class="o">=</span> <span class="n">float_to_ctx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">)</span>
<span class="n">ctx2</span> <span class="o">=</span> <span class="n">float_to_ctx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">encryptor2</span><span class="p">)</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ctx1</span><span class="p">,</span><span class="n">ctx2</span><span class="p">,</span><span class="n">ctx1</span><span class="p">)</span>

<span class="n">print_ctx</span><span class="p">(</span><span class="n">ctx1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">float_to_ctx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">powers</span> <span class="o">=</span> <span class="n">compute_all_powers</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="n">evaluator</span><span class="p">,</span> <span class="n">relin_keys</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">**</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">print_ctx</span><span class="p">(</span><span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.5**1

    [ 0.4999978, 0.5000039, 0.5000147, ..., 0.4999935, 0.4999968, 0.5000006 ]

0.5**2

    [ 0.2499960, 0.2500039, 0.2500036, ..., 0.2499864, 0.2499931, 0.2500029 ]

0.5**3

    [ 0.1249970, 0.1250122, 0.1250121, ..., 0.1249804, 0.1249850, 0.1250007 ]

0.5**4

    [ 0.0624928, 0.0624999, 0.0624953, ..., 0.0624884, 0.0624819, 0.0624987 ]

0.5**5

    [ 0.0312464, 0.0312442, 0.0312510, ..., 0.0312469, 0.0312411, 0.0312508 ]

0.5**6

    [ 0.0156271, 0.0156262, 0.0156236, ..., 0.0156380, 0.0156255, 0.0156251 ]

0.5**7

    [ 0.0078085, 0.0078170, 0.0078146, ..., 0.0077920, 0.0078063, 0.0078179 ]

0.5**8

    [ 0.0039047, 0.0038920, 0.0039007, ..., 0.0038930, 0.0039145, 0.0039048 ]

0.5**9

    [ 0.0019534, 0.0019474, 0.0019529, ..., 0.0019569, 0.0019699, 0.0019517 ]

0.5**10

    [ 0.0009808, 0.0009777, 0.0009712, ..., 0.0009695, 0.0009703, 0.0009707 ]

0.5**11

    [ 0.0004918, 0.0004838, 0.0004840, ..., 0.0004875, 0.0004736, 0.0004937 ]

0.5**12

    [ 0.0002416, 0.0002367, 0.0002393, ..., 0.0002433, 0.0002585, 0.0002410 ]

0.5**13

    [ 0.0001228, 0.0001235, 0.0001173, ..., 0.0001319, 0.0001255, 0.0001195 ]

0.5**14

    [ 0.0000626, 0.0000630, 0.0000659, ..., 0.0000623, 0.0000687, 0.0000545 ]

0.5**15

    [ 0.0000283, 0.0000382, 0.0000362, ..., 0.0000344, 0.0000410, 0.0000361 ]

0.5**16

    [ 0.0000084, 0.0000131, 0.0000189, ..., 0.0000140, 0.0000063, 0.0000167 ]

0.5**17

    [ 0.0000066, 0.0000086, 0.0000068, ..., 0.0000028, 0.0000071, 0.0000095 ]

0.5**18

    [ -0.0000021, 0.0000014, 0.0000013, ..., -0.0000058, 0.0000101, 0.0000141 ]

0.5**19

    [ -0.0000002, 0.0000036, -0.0000026, ..., -0.0000029, -0.0000006, 0.0000071 ]

0.5**20

    [ 0.0000031, -0.0000050, -0.0000008, ..., 0.0000040, 0.0000079, 0.0000027 ]

0.5**21

    [ 0.0000014, -0.0000003, 0.0000025, ..., 0.0000127, 0.0000123, 0.0000009 ]

0.5**22

    [ 0.0000021, 0.0000039, -0.0000040, ..., 0.0000033, 0.0000054, 0.0000032 ]

0.5**23

    [ -0.0000057, -0.0000025, -0.0000050, ..., -0.0000021, 0.0000158, 0.0000014 ]

0.5**24

    [ -0.0000031, 0.0000034, 0.0000006, ..., 0.0000055, -0.0000061, -0.0000041 ]

0.5**25

    [ 0.0000020, 0.0000031, 0.0000069, ..., -0.0000253, 0.0000266, 0.0000040 ]

0.5**26

    [ 0.0000018, 0.0000000, -0.0000032, ..., -0.0000105, -0.0000142, 0.0000052 ]

0.5**27

    [ 0.0000017, 0.0000026, -0.0000024, ..., 0.0000011, -0.0000021, 0.0000033 ]

0.5**28

    [ -0.0000060, 0.0000016, 0.0000020, ..., 0.0000005, 0.0000072, 0.0000009 ]

0.5**29

    [ 0.0000061, -0.0000071, -0.0000035, ..., -0.0000073, -0.0000140, 0.0000009 ]

0.5**30

    [ -0.0000022, -0.0000057, 0.0000019, ..., 0.0000027, 0.0000002, 0.0000013 ]

0.5**31

    [ -0.0000010, -0.0000027, -0.0000093, ..., 0.0000121, -0.0000052, 0.0000001 ]

0.5**32

    [ 0.0000030, 0.0000028, 0.0000016, ..., 0.0000090, 0.0000016, 0.0000024 ]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">evaluator</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plain_coeffs</span> <span class="o">=</span> <span class="n">coeffs_to_plaintext</span><span class="p">(</span><span class="n">coefs</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>

<span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">coeff</span><span class="p">,</span><span class="n">plain_coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coefs</span><span class="p">,</span><span class="n">plain_coeffs</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">DoubleVector</span><span class="p">()</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">plain_coeff</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
    <span class="n">approx_coeff</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coeff</span> <span class="o">-</span> <span class="n">approx_coeff</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected : </span><span class="si">{</span><span class="n">coeff</span><span class="si">}</span><span class="s2">, approx : </span><span class="si">{</span><span class="n">approx_coeff</span><span class="si">}</span><span class="s2">, distance : </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean difference : </span><span class="si">{</span><span class="n">mean_diff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Expected : 0.5000000000000016, approx : 0.5, distance : 1.5543122344752192e-15
Expected : 3.474584184442049, approx : 3.4745841844414826, distance : 5.662137425588298e-13
Expected : -1.6864940816423554e-13, approx : 0.0, distance : 1.6864940816423554e-13
Expected : -31.737739178994442, approx : -31.737739178992342, distance : 2.099653784171096e-12
Expected : 3.463686853672912e-12, approx : 0.0, distance : 3.463686853672912e-12
Expected : 179.0966172227143, approx : 179.0966172227054, distance : 8.895995051716454e-12
Expected : -2.8244073746463982e-11, approx : -2.9103830456733704e-11, distance : 8.597567102697212e-13
Expected : -569.8609883915542, approx : -569.8609883915633, distance : 9.094947017729282e-12
Expected : 1.1444252081941264e-10, approx : 1.1641532182693481e-10, distance : 1.9728010075221757e-12
Expected : 1051.2108524907835, approx : 1051.2108524907962, distance : 1.2732925824820995e-11
Expected : -2.5202365684569536e-10, approx : -2.6193447411060333e-10, distance : 9.910817264907972e-12
Expected : -1115.366118183569, approx : -1115.3661181835632, distance : 5.6843418860808015e-12
Expected : 3.0666021356249563e-10, approx : 3.2014213502407074e-10, distance : 1.348192146157511e-11
Expected : 631.2128200850321, approx : 631.2128200850275, distance : 4.661160346586257e-12
Expected : -1.9366887178929418e-10, approx : -2.0372681319713593e-10, distance : 1.0057941407841746e-11
Expected : -147.53221845000354, approx : -147.532218450011, distance : 7.44648787076585e-12
Expected : 4.9540711402454795e-11, approx : 5.820766091346741e-11, distance : 8.666949511012612e-12
Mean difference : 5.86857667421356e-12
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>coeffs_to_plaintext
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">multiply_and_add_coeffs</span><span class="p">(</span><span class="n">evaluator</span><span class="p">,</span> <span class="n">encryptor</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">plain_coeffs</span><span class="p">,</span> <span class="n">coefs</span><span class="p">,</span> <span class="n">PRECISION_BITS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 Expected output : 1.7372920174733142, output : 1.7373085329300606
3 Expected output : -3.9672168853008234, output : -3.9674249848818017
5 Expected output : 5.596768084193369, output : 5.597435644918786
7 Expected output : -4.452037630953475, output : -4.452716435287793
9 Expected output : 2.0531454012340267, output : 2.0535564731373697
11 Expected output : -0.5446121046404848, output : -0.5446871509542115
13 Expected output : 0.07705230310407982, output : 0.07709149596439588
15 Expected output : -0.004502323096786874, output : -0.0045011522573293085
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_ctx</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
    [ 0.9960624, 0.9960711, 0.9962032, ..., 0.9958951, 0.9960536, 0.9960583 ]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">DoubleVector</span><span class="p">()</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">plain_coeffs</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
<span class="n">print_vector</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
    [ 218730255.213, 218730255.213, 218730255.213, 218730255.213, ..., 218730255.213, 218730255.213, 218730255.213, 218730255.213 ]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">evaluator</span><span class="o">.</span><span class="n">square_inplace</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">DoubleVector</span><span class="p">()</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">ptx</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
<span class="n">print_vector</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
    [ 0.5000000, 0.5000000, 0.5000000, ..., 0.5000000, 0.5000000, 0.5000000 ]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ctx</span> <span class="o">=</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

